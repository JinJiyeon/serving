# [91_Evaluation](./91_Evaluation)

#### 기본 정보

- 목적 : 프로그램을 평가하는 툴에 대해 알아보자
- 기간 : 2021/12
- Ref :

## 테스트

- 성능 테스트 : 속도, 확장성, 안정성 측면

- 부하 테스트 : 앱의 최대 로드, 디비의 최대 데이터 양, 네트워크 통신량

- 스트레스 테스트 : 서버가 고장날 경우에 어떻게 복구할 것인가

  

## API

- API 는 스피드가 중요하고, throughput 과 latency 를 기준으로 평가할 수 있다.

- wrk

  

- throughput  = 초당 얼마나 많은 데이터를 처리하느냐

- Transfer / sec
  초당 전송된 데이터 양을 측정한다.
  다만 데이터 사이즈가 큰 객체를 전송할 경우 왜곡될 가능성이 있다. (데이터 양이 많다고 스피드가 빠른 건 아니라는 뜻)
  요즘의 네트워크 망은 초당 100MB를 보낸다. 따라서 그 이상의 점수는 무의미하다.

- Request / sec
  초당 처리하는 요청의 개수이다.
  많을수록 좋고, 최소한 500은 넘는 것을 목표로 했다.

- Latency Distribution
  1 s = 1000 ms 이다.
  2 s 이상 넘어가는 않는 것을 목표로 했다.



## Memory

- Memory 가 충분한지 체크한다.

- visual VM

  

- JVM에서 Garbage collection을 자동으로 해준다. 하지만 완벽하지는 않다.

- 어디서 메모리 누수가 발생하는 건지 분석해보았다.

- 원시형 변수는 stack memory 에, 참조형 변수는 heap memory 에 저장된다.
  함수가 종료될 때마다 stack은 비워지는 반면, heap 은 GC + 개발자가 지워줘야 한다.
  heap에서 이름이 있는 객체는 지웠지만, 임시로 생성한 객체를 지우지 않았다.
  여기서 메모리 누수가 발생한 것 같다.



- GC + 개발자는 완벽하지 않고, 언젠가는 메모리 용량이 초과한다. 이에 대한 해결책을 알아보았다.
- 결국 서버를 완전히 껐다 키는 작업이 필요하다.
  서버를 껐다 킬 때에 여러 가지 작업이 수반되는데, 
  이에 대한 내용을 shell script 로 작성하고,
  crontab | jenkins 의 도움으로 자동화할 수 있다.



